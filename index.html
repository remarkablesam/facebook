<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Know Empire Marketplace</title>
    <!-- Google Fonts - Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Google Fonts - Inter (from previous versions, keeping for consistency if desired) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <header class="topbar">
        <a href="#" class="logo fb-blue">KnowEmpire</a>
        <div class="header-actions">
            <!-- Removed textPostBtn from here -->
            <button class="header-btn" id="addBtn"><span class="material-icons">add</span></button>
            <button class="header-btn" id="searchBtn"><span class="material-icons">search</span></button>
            <button class="header-btn" id="chatBtn"><span class="material-icons">chat_bubble_outline</span></button>
        </div>
    </header>

    <nav class="fb-nav">
        <button class="nav-btn" id="homeNavBtn"><span class="material-icons">home</span></button>
        <button class="nav-btn" id="adsNavBtn"><span class="material-icons">storefront</span></button> <!-- Ads Button -->
        <button class="nav-btn" id="usersNavBtn"><span class="material-icons">group</span></button> <!-- Users Button -->
        <button class="nav-btn" id="notificationsNavBtn"><span class="material-icons">notifications</span></button>
        <button class="nav-btn" id="menuNavBtn"><span class="material-icons">menu</span></button>
    </nav>

    <!-- Main Content Area (Home Feed) -->
    <main class="page-container" id="mainContent">
        <div class="status-bar">
            <img src="https://placehold.co/40x40/cccccc/333333?text=P" alt="Profile" class="profile-pic" id="statusBarProfilePic">
            <input type="text" placeholder="Search products..." id="statusBarSearchInput">
            <button class="photo-btn"><span class="material-icons">photo_library</span></button> <!-- Removed "Photo" label -->
        </div>

        <div class="stories">
            <h3 style="padding-left: 8px; margin-bottom: 10px; font-size: 1.1rem; font-weight: 600; color: #333;">Stories</h3>
            <div class="story-cards" id="storyCards">
                <!-- Story cards will be injected here by JavaScript -->
            </div>
        </div>

        <!-- Category Filter Bar -->
        <div class="category-filter-bar" id="categoryFilterBar">
            <button class="active" data-category="All">All</button>
            <button data-category="Electronics">Electronics</button>
            <button data-category="Fashion">Fashion</button>
            <button data-category="Home">Home & Garden</button>
            <button data-category="Vehicles">Vehicles</button>
            <button data-category="Services">Services</button>
            <button data-category="Other">Other</button>
            <button id="clearFiltersBtn">Clear Filters</button>
        </div>

        <div class="product-grid" id="productList">
            <!-- Product, Ad, and Text Post cards will be injected here by JavaScript -->
            <div style="text-align: center; padding: 20px; color: #666; width: 100%; display: none;" id="emptyProductListMessage">No products, ads, or posts available. Be the first to post!</div>
        </div>
    </main>

    <!-- Users List Page -->
    <div class="page-container" id="usersListPage">
        <h3 style="margin-bottom: 15px; font-size: 1.5rem; text-align: center; color: #333;">All Users</h3>
        <div class="users-grid" id="usersGrid">
            <!-- User cards will be injected here by JavaScript -->
            <div style="text-align: center; padding: 20px; color: #666; width: 100%; display: none;" id="emptyUsersListMessage">No users registered yet.</div>
        </div>
    </div>

    <!-- Profile Page Container (now dynamic for any user) -->
    <div class="page-container" id="profilePageContainer">
        <div class="page-header" id="profilePageHeader">
            <button class="back-btn" id="profileBackBtn"><span class="material-icons">arrow_back</span></button>
            <span class="page-title">Profile</span>
        </div>
        <div class="profile-header">
            <img src="https://placehold.co/600x180/9b23ea/ffffff?text=KnowEmpire+Banner" alt="Profile Banner" class="banner-img" id="profileBannerImg">
            <div class="profile-picture-container">
                <img id="userProfileImageLarge" src="https://placehold.co/150x150/cccccc/333333?text=P" alt="User Profile" class="profile-img-large">
                <span class="material-icons camera-icon">photo_camera</span>
            </div>
            <div class="profile-info-section">
                <h2 id="profileNameDisplay"></h2>
                <div class="profile-stats">
                    <p><span>4.8K</span> followers</p>
                    <p><span>217</span> following</p>
                </div>
                <div class="profile-actions-row">
                    <button class="action-btn professional" id="professionalDashboardBtn">
                        <span class="material-icons">dashboard</span> Professional dashboard
                    </button>
                    <button class="secondary-btn" id="addToStoryBtn">
                        <span class="material-icons">add</span> Add to story
                    </button>
                    <button class="action-btn follow-btn" id="followUserBtn" style="display: none;">
                        <span class="material-icons">person_add</span> Follow
                    </button>
                     <button class="secondary-btn following-btn" id="unfollowUserBtn" style="display: none;">
                        <span class="material-icons">check</span> Following
                    </button>
                    <button class="more-options-btn" id="moreOptionsBtn">
                        <span class="material-icons">more_horiz</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="profile-tabs">
            <div class="profile-tab-item active" data-tab="posts">Posts</div>
            <div class="profile-tab-item" data-tab="about">About</div>
            <div class="profile-tab-item" data-tab="reels">Reels</div>
            <div class="profile-tab-item" data-tab="photos">Photos</div>
            <div class="profile-tab-item" data-tab="videos">Videos</div>
        </div>

        <!-- Tab Content Area -->
        <div id="profileTabContent">
            <!-- Posts Tab Content -->
            <div id="postsTab" class="profile-content-section">
                <div class="profile-details-section">
                    <h3>Details</h3>
                    <div class="detail-item"><span class="material-icons">person</span> Profile â€¢ Digital creator</div>
                    <div class="detail-item"><span class="material-icons">info</span> Bio: <span id="profileBio">No bio yet.</span></div>
                    <div class="detail-item"><span class="material-icons">link</span> Social: <a href="#" id="profileSocialLink" target="_blank">Not set</a></div>
                    <button class="edit-public-btn" id="editPublicDetailsBtn">Edit Public Details</button>
                </div>

                <div class="post-creation-section profile-content-section" style="margin-top: 10px;">
                    <h3>Posts</h3>
                    <div class="post-creation-top">
                        <img id="postCreationProfilePic" src="https://placehold.co/40x40/cccccc/333333?text=P" alt="Profile" class="profile-pic-small">
                        <input type="text" placeholder="Post a status update" id="postStatusInput">
                    </div>
                    <div class="post-creation-actions">
                        <div class="action-item photo"><span class="material-icons">photo_library</span> Photo</div>
                        <div class="action-item reels"><span class="material-icons">videocam</span> Reels</div>
                        <div class="action-item event"><span class="material-icons">event</span> Life event</div>
                    </div>
                </div>

                <!-- User's Products will be displayed here -->
                <div class="product-grid" id="myProductsList">
                    <!-- Products, Ads, and Text Posts posted by the logged-in user will be injected here -->
                    <div style="text-align: center; padding: 20px; color: #666; width: 100%; display: none;" id="emptyMyProductsMessage">This user has not posted any products, ads, or text posts yet.</div>
                </div>
            </div>

            <!-- About Tab Content (Placeholder) -->
            <div id="aboutTab" class="profile-content-section" style="display: none;">
                <h3>About</h3>
                <p>This section will contain detailed information about the user.</p>
                <div class="detail-item"><span class="material-icons">phone</span> Phone: <span id="aboutUserPhone"></span></div>
                <div class="detail-item"><span class="material-icons">location_on</span> Location: <span id="aboutUserLocation"></span></div>
                <div class="detail-item"><span class="material-icons">account_balance</span> Bank Name: <span id="aboutUserBankName"></span></div>
                <div class="detail-item"><span class="material-icons">account_circle</span> Username: <span id="aboutUserUsername"></span></div>
                <button class="action-btn" id="aboutEditProfileBtn" style="margin-top: 20px;">Edit Profile</button>
                <button class="secondary-btn" id="aboutLogoutBtn" style="margin-top: 10px;">Logout</button>
            </div>

            <!-- Reels, Photos, Videos Tabs Content (Placeholders) -->
            <div id="reelsTab" class="profile-content-section" style="display: none;">
                <h3>Reels</h3>
                <p>This section will display the user's reels.</p>
            </div>
            <div id="photosTab" class="profile-content-section" style="display: none;">
                <h3>Photos</h3>
                <p>This section will display the user's photos.</p>
            </div>
            <div id="videosTab" class="profile-content-section" style="display: none;">
                <h3>Videos</h3>
                <p>This section will display the user's videos.</p>
            </div>
        </div>
    </div>

    <!-- Standalone Ad Details Page -->
    <div class="page-container" id="adDetailsPage">
        <div class="page-header" id="adDetailsPageHeader">
            <button class="back-btn" id="adDetailsBackBtn"><span class="material-icons">arrow_back</span></button>
            <span class="page-title">Ad Details</span>
        </div>
        <div class="ad-details-content">
            <img id="adDetailsImage" src="" alt="Ad Image">
            <h2 id="adDetailsTitle"></h2>
            <p id="adDetailsDescription"></p>
            <div class="detail-row">
                <span>Category:</span>
                <strong id="adDetailsCategory"></strong>
            </div>
            <div class="detail-row">
                <span>Location:</span>
                <strong id="adDetailsLocation"></strong>
            </div>
            <div class="detail-row">
                <span>Duration:</span>
                <strong id="adDetailsDuration"></strong> days
            </div>
            <div class="detail-row">
                <span>Budget:</span>
                <strong>â‚¦<span id="adDetailsBudget"></span></strong>
            </div>
            <p class="seller-info">Advertiser: <span id="adDetailsContactUsername"></span> (<span id="adDetailsContactPhone"></span>)</p>
            <p class="user-id-display">Advertiser User ID: <span id="adDetailsUserId"></span></p>

            <div class="comments-section">
                <h4>Comments</h4>
                <div class="comments-list" id="adCommentsList">
                    <!-- Ad comments will be injected here -->
                    <div style="text-align: center; color: #888;">No comments yet.</div>
                </div>
                <div class="comment-input-container">
                    <input type="text" id="newAdCommentInput" placeholder="Add a comment...">
                    <button id="postAdCommentBtn">Post</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifications Modal -->
    <div class="page-container" id="notificationsModal">
        <div class="page-header" id="notificationsPageHeader">
            <button class="back-btn" id="notificationsBackBtn"><span class="material-icons">arrow_back</span></button>
            <span class="page-title">Notifications</span>
        </div>
        <div class="notifications-list" id="notificationsList">
            <!-- Notifications will be injected here -->
            <div style="text-align: center; padding: 20px; color: #666; display: none;" id="noNotificationsMessage">No new notifications.</div>
        </div>
        <div class="notifications-actions">
            <button id="markAllReadBtn">Mark All Read</button>
            <button id="clearAllNotificationsBtn">Clear All</button>
            <button id="addTestNotificationBtn">Add Test Notification</button>
        </div>
    </div>

    <!-- Chat Modal -->
    <div class="page-container" id="chatModal">
        <div class="page-header" id="chatPageHeader">
            <button class="back-btn" id="chatBackBtn"><span class="material-icons">arrow_back</span></button>
            <img src="https://placehold.co/36x36/9b23ea/ffffff?text=S" alt="Support" class="chat-profile-pic">
            <span class="page-title chat-title">KnowEmpire Support</span>
        </div>
        <div class="chat-messages" id="chatMessages">
            <!-- Chat messages will be injected here -->
            <!-- Initial bot message is added by JS -->
        </div>
        <div class="chat-input-area">
            <input type="text" id="chatTextInput" placeholder="Type a message...">
            <button id="sendTextBtn"><span class="material-icons">send</span></button>
            <input type="file" id="chatPhotoInput" accept="image/*" style="display: none;">
            <button id="sendPhotoBtn"><span class="material-icons">image</span></button>
            <button id="sendVoiceBtn"><span class="material-icons">mic</span></button>
        </div>
    </div>

    <!-- Ads Full Page -->
    <div class="page-container" id="adsFullPage">
        <div class="ads-page-header">
            <button class="back-btn" id="adsPageBackBtn"><span class="material-icons">arrow_back</span></button>
            <span class="page-title">All Ads</span>
            <button class="create-ad-btn" id="createAdBtnHeader">
                <span class="material-icons">add</span> Create Ad
            </button>
        </div>
        <div class="ads-page-content" id="adsListContent">
            <!-- Ads will be injected here -->
            <div style="text-align: center; padding: 20px; color: #666; width: 100%; display: none;" id="emptyAdsListMessage">No ads available. Be the first to create one!</div>
        </div>
    </div>

    <!-- Floating Action Buttons Container -->
    <div class="fab-container">
        <button class="text-post-fab" id="textPostBtn"><span class="material-icons">text_fields</span></button>
        <div class="fab" id="fab">
            <span class="material-icons">add</span>
        </div>
    </div>


    <!-- Upload Product Modal -->
    <div id="uploadModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeUploadModal">&times;</span>
            <h3 style="margin-bottom: 15px; font-size: 1.5rem; text-align: center; color: #333;" id="uploadModalTitle">Upload New Product</h3>
            <form id="uploadForm">
                <label for="productImage" class="upload-label">
                    <span class="material-icons">cloud_upload</span> Select Image
                    <input type="file" id="productImage" accept="image/*">
                </label>
                <div class="preview-container">
                    <img id="imagePreview" class="image-preview" src="" alt="Image Preview" style="display: none;">
                </div>
                <input type="text" id="productName" placeholder="Product Name" required>
                <span class="error-message" id="productNameError"></span>
                <textarea id="productDescription" placeholder="Product Description" rows="3" required></textarea>
                <button type="button" class="ai-button" id="enhanceDescriptionBtn">âœ¨ Enhance Description</button>
                <span class="error-message" id="productDescriptionError"></span>
                <select id="productCategory" required>
                    <option value="">Select Category</option>
                    <option value="Electronics">Electronics</option>
                    <option value="Fashion">Fashion</option>
                    <option value="Home">Home & Garden</option>
                    <option value="Vehicles">Vehicles</option>
                    <option value="Services">Services</option>
                    <option value="Other">Other</option>
                </select>
                <span class="error-message" id="productCategoryError"></span>
                <input type="number" id="priceNaira" placeholder="Price in Naira (â‚¦)" required>
                <span class="error-message" id="priceNairaError"></span>
                <div class="converted-price" id="convertedPrice"></div>
                <div class="loading-spinner" id="uploadSpinner"></div>
                <button type="submit" class="action-btn" id="uploadProductSubmitBtn">Upload Product</button>
            </form>
        </div>
    </div>

    <!-- Create Ad Modal -->
    <div id="createAdModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeCreateAdModal">&times;</span>
            <h3 style="margin-bottom: 15px; font-size: 1.5rem; text-align: center; color: #333;" id="createAdModalTitle">Create New Ad</h3>
            <form id="createAdForm">
                <label for="adImage" class="upload-label">
                    <span class="material-icons">cloud_upload</span> Select Ad Image
                    <input type="file" id="adImage" accept="image/*">
                </label>
                <div class="preview-container">
                    <img id="adImagePreview" class="image-preview" src="" alt="Ad Image Preview" style="display: none;">
                </div>
                <input type="text" id="adTitle" placeholder="Ad Title/Headline" required>
                <span class="error-message" id="adTitleError"></span>
                <textarea id="adDescription" placeholder="Ad Description" rows="3" required></textarea>
                <span class="error-message" id="adDescriptionError"></span>
                <select id="adCategory" required>
                    <option value="">Select Category</option>
                    <option value="Electronics">Electronics</option>
                    <option value="Fashion">Fashion</option>
                    <option value="Home">Home & Garden</option>
                    <option value="Vehicles">Vehicles</option>
                    <option value="Services">Services</option>
                    <option value="Other">Other</option>
                </select>
                <span class="error-message" id="adCategoryError"></span>
                <input type="text" id="adLocation" placeholder="Target Location (e.g., Lagos, Nigeria)" required>
                <span class="error-message" id="adLocationError"></span>
                <input type="number" id="adDuration" placeholder="Duration (days)" min="1" required>
                <span class="error-message" id="adDurationError"></span>
                <input type="number" id="adBudget" placeholder="Budget in Naira (â‚¦)" min="100" required>
                <span class="error-message" id="adBudgetError"></span>
                <div class="loading-spinner" id="adSpinner"></div>
                <button type="submit" class="action-btn" id="createAdSubmitBtn">Post Ad</button>
            </form>
        </div>
    </div>

    <!-- Create Text Post Modal -->
    <div id="textPostModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeTextPostModal">&times;</span>
            <h3 style="margin-bottom: 15px; font-size: 1.5rem; text-align: center; color: #333;">Create Text Post</h3>
            <form id="textPostForm">
                <textarea id="textPostContent" placeholder="What's on your mind?" rows="5" required></textarea>
                <span class="error-message" id="textPostContentError"></span>
                <p style="margin-top: 10px; margin-bottom: 8px; font-size: 0.95rem; color: #555;">Choose a theme color:</p>
                <div class="color-palette" id="colorPalette">
                    <div class="color-swatch selected" data-color="#9b23ea" style="background-color: #9b23ea;"></div>
                    <div class="color-swatch" data-color="#1877f2" style="background-color: #1877f2;"></div>
                    <div class="color-swatch" data-color="#42b72a" style="background-color: #42b72a;"></div>
                    <div class="color-swatch" data-color="#f02849" style="background-color: #f02849;"></div>
                    <div class="color-swatch" data-color="#f7b928" style="background-color: #f7b928;"></div>
                    <div class="color-swatch" data-color="#00bcd4" style="background-color: #00bcd4;"></div>
                    <div class="color-swatch" data-color="#ff9800" style="background-color: #ff9800;"></div>
                    <div class="color-swatch" data-color="#795548" style="background-color: #795548;"></div>
                </div>
                <div class="loading-spinner" id="textPostSpinner"></div>
                <button type="submit" class="action-btn" id="postTextBtn">Post Text</button>
            </form>
        </div>
    </div>


    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeLoginModal">&times;</span>
            <h3 style="margin-bottom: 15px; font-size: 1.5rem; text-align: center; color: #333;">Login</h3>
            <form id="loginForm">
                <input type="text" id="loginUsername" placeholder="Username or Email" required>
                <span class="error-message" id="loginUsernameError"></span>
                <input type="password" id="loginPassword" placeholder="Password" required>
                <span class="error-message" id="loginPasswordError"></span>
                <button type="submit" class="action-btn">Login</button>
                <button type="button" class="secondary-btn" id="goToSignupBtn">Don't have an account? Sign Up</button>
            </form>
        </div>
    </div>

    <!-- Signup Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeSignupModal">&times;</span>
            <h3 style="margin-bottom: 15px; font-size: 1.5rem; text-align: center; color: #333;">Create Your Account</h3>
            <form id="signupForm">
                <label for="profilePhoto" class="profile-upload-label">
                    <img id="profilePhotoPreview" src="https://placehold.co/80x80/cccccc/333333?text=P" alt="Profile Photo Preview">
                    <span class="material-icons">add_a_photo</span> Upload Photo
                    <input type="file" id="profilePhoto" accept="image/*">
                </label>
                <input type="text" id="signupName" placeholder="Your Full Name" required>
                <span class="error-message" id="signupNameError"></span>
                <input type="tel" id="signupPhone" placeholder="Phone Number (e.g., 08012345678)" required>
                <span class="error-message" id="signupPhoneError"></span>
                <input type="text" id="signupLocation" placeholder="Your Location" required>
                <span class="error-message" id="signupLocationError"></span>
                <div style="display: flex; align-items: center; margin-bottom: 10px;">
                    <input type="number" id="signupAccountNumber" placeholder="Bank Account Number" required>
                    <span class="signup-spinner-container"><div id="accountNumberSpinner" class="signup-spinner"></div></span>
                </div>
                <span class="error-message" id="signupAccountNumberError"></span>
                <input type="text" id="signupAccountName" placeholder="Bank Account Name" disabled>
                <span class="error-message" id="signupAccountNameError"></span>
                <input type="text" id="signupBankName" placeholder="Bank Name" disabled>
                <span class="error-message" id="signupBankNameError"></span>
                <hr style="margin: 15px 0; border: none; border-top: 1px solid #eee;">
                <input type="text" id="signupUsername" placeholder="Choose a Username or Email" required>
                <span class="error-message" id="signupUsernameError"></span>
                <input type="password" id="signupPassword" placeholder="Choose a Password" required>
                <span class="error-message" id="signupPasswordError"></span>
                <button type="submit" class="action-btn">Sign Up</button>
                <button type="button" class="secondary-btn" id="goToLoginBtn">Already have an account? Login</button>
            </form>
        </div>
    </div>

    <!-- Item Details Modal (Generalized from Product Details) -->
    <div id="itemDetailsModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeItemDetailsModal">&times;</span>
            <img id="detailsImage" src="" alt="Item Image" style="display: none;"> <!-- Hidden for text posts -->
            <h3 id="detailsTitle"></h3>
            <p id="detailsDescription"></p>
            <div class="detail-row" id="detailsCategoryRow">
                <span>Category:</span>
                <strong id="detailsCategory"></strong>
            </div>
            <div class="detail-row" id="detailsPriceRow">
                <span>Price:</span>
                <strong id="detailsPriceNaira"></strong> (<span id="detailsPriceDollar"></span>)
            </div>
            <div class="detail-row" id="detailsLocationRow" style="display: none;">
                <span>Location:</span>
                <strong id="detailsLocation"></strong>
            </div>
            <div class="detail-row" id="detailsDurationRow" style="display: none;">
                <span>Duration:</span>
                <strong id="detailsDuration"></strong> days
            </div>
            <div class="detail-row" id="detailsBudgetRow" style="display: none;">
                <span>Budget:</span>
                <strong id="detailsBudget"></strong>
            </div>
            <p class="user-id-display">Posted by: <span id="detailsContactUsername"></span> (<span id="detailsContactPhone"></span>)</p>
            <p class="user-id-display">User ID: <span id="detailsUserId"></span></p>

            <div class="comments-section">
                <h4>Comments</h4>
                <div class="comments-list" id="itemCommentsList">
                    <!-- Item comments will be injected here -->
                    <div style="text-align: center; color: #888;">No comments yet.</div>
                </div>
                <div class="comment-input-container">
                    <input type="text" id="newItemCommentInput" placeholder="Add a comment...">
                    <button id="postItemCommentBtn">Post</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Timed Message Popup -->
    <div id="timedMessagePopup"></div>

    <!-- Custom Alert/Confirm Modal Structure -->
    <div id="customAlertModal" class="custom-alert-modal">
        <div class="custom-alert-content">
            <h3 id="customAlertTitle">Alert</h3>
            <p id="customAlertMessage">This is a custom alert message.</p>
            <div class="custom-alert-buttons">
                <button class="custom-alert-ok-btn" id="customAlertOkBtn">OK</button>
                <button class="custom-alert-cancel-btn" id="customAlertCancelBtn" style="display: none;">Cancel</button>
            </div>
        </div>
    </div>

    <script src="index.js"></script>
</body>
</html>
